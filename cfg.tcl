#source "routerlib.tcl"namespace eval cfg {variable myMac "00:00:00:00:00:11"variable PID_IP "0800"variable IP_Version 4array set port {F1/0 30001F0/0 30003}array set remote_port {F1/0 30000F0/0 30002}array set remote_host {F1/0 127.0.0.1F0/0 127.0.0.1}array set host {OSPF_server   127.0.0.1router_server 127.0.0.1}array set port {OSPF_server   20000router_server 10000}}namespace eval OSPF_cfg {#------------------------------------------Ospf header------------------------------------------------------#26 B8B8B16B32B32B32B16B64 Version Type Len RID AID Checksum Auth_Type Auth_Datavariable RID 200.0.0.1proc set_rid {rid} {set OSPF_util::RID $rid}variable Version 2array set Pkt_Type {Hello 1DD    2LSR   3LSU   4LSAck 5}variable Len 0proc set_Len {len} {set OSPF_cfg::Len $len}#------------------------------------------Ospf Hello------------------------------------------------------#24 B32B16B8B8B32B32B32B32 Network_Mask Interval Options Pri Dead_Interval DR BDR Neighbor*#------------------------------------------Ospf DD------------------------------------------------------#28 B16B8B5B1B1B1B32B160 OSPF.DD.IfMTU OSPF.DD.DD_Options OSPF.DD.Reserved1 OSPF.DD.InitBit OSPF.DD.MoreBit OSPF.DD.MasterBit OSPF.DD.DD_Sequence OSPF.DD.LSA_Header*#------------------------------------------Ospf LSA_Header------------------------------------------------------#20 B16B8B8B32B32B32B16B16 OSPF.LSA_Header.Age OSPF.LSA_Header.Options OSPF.LSA_Header.LSA_Type OSPF.LSA_Header.Link_State_ID OSPF.LSA_Header.Advertising_Router OSPF.LSA_Header.Sequence OSPF.LSA_Header.Checksum OSPF.LSA_Header.Len#Age: Add InfTransDelay seconds when flooded, add 1 second in local DBarray set LSA_Age {init 1max  3600}#LSA_Header_Options: may different from DD_Options#DN-VPN Opaque DC-demand L-LLS NP-NSSA MC=multicast E-external MT-topologyvariable OSPF.LSA_Header.Options 00100010proc set_OSPF.LSA_Header.Options {in} {set OSPF.LSA_Header.Options $in} array set LSA_Type {Router  1Network 2NetSum  3ASBR    4AsExt  5Group   6NSSA    7ExtAttr 8OpaqueLink 9OpaqueArea 10OpaqueAS   11}# Link_State_ID#router-RID #net-DR_If_IP #netsum-IP address of the network or subnet #ASBR-ASBR_RID#AsExt-Dest_IP#NSSA-Dest_IP#Advertising_Router: from LSAarray set LSA_Sequence {init   0x80000001 max    0x7ffffff}#LSA_Len including the header#------------------------------------------Ospf LSR------------------------------------------------------#12 B32B32B32 OSPF.LSR.LSA_Type OSPF.LSR.Link_State_ID OSPF.LSR.Advertising_Router#------------------------------------------Ospf LSAck------------------------------------------------------#20 B160 OSPF.LSAck.LSA_Header*#------------------------------------------Ospf Router_LSA------------------------------------------------------#20 B5B1B1B1B8B16B128 OSPF.Router_LSA.Reserved1 OSPF.Router_LSA.VL_Bit OSPF.Router_LSA.ASBR_Bit OSPF.Router_LSA.ABR_Bit OSPF.Router_LSA.Reserved2 OSPF.Router_LSA.Links_Num OSPF.Router_LSA.Link*variable VL_Bit 0variable ASBR_bit 0variable ABR_bit 0#-------------------------------------------OSPF Link---------------------------------------------------array set Link_Type {p2p      1transit  2stub 	 3vl       4F0/0  3   F1/0  3}array set Link_ID {F0/0      0F1/0      0}array set Link_Data {F0/0      0F1/0      0}variable TOS_Num     0array set Network_Type {P2P 1Broadcast 2NBMA 3P2MP 4Virtual_Link 5}array set Interface_Data {F0/0)(Mib_II 1F0/0)(Type "Broadcast"F0/0)(State "Down"F0/0)(IP 1.0.0.1F0/0)(Mask 8F0/0)(AID 0F0/0)(HelloInterval 10F0/0)(RouterDeadInterval 40 F0/0)(InfTransDelay 1F0/0)(RouterPri 1F0/0)(HelloTimer 10F0/0)(WaitTimer 40F0/0)(Neighbor* ""F0/0)(DR  0.0.0.0F0/0)(DR_IF_IP 0.0.0.0F0/0)(BDR  0.0.0.0F0/0)(OutCost 10F0/0)(RxmtInterval 5F0/0)(OutCost 10F0/0)(AuType 0F0/0)(AuKey 0F0/0)(MTU 1500}     variable Number_of_Links 2#DN-VPN Opaque DC-demand L-LLS NP-NSSA MC=multicast E-external MT-topologyarray set Hello_Options {F0/0 00000010F1/0 00000010}#DN-VPN Opaque DC-demand L-LLS NP-NSSA MC=multicast E-external MT-topologyarray set DD_Options {F0/0 00010010F1/0 00010010}array set InitBit {F0/0 1F1/0 1}array set MoreBit {F0/0 1F1/0 1}array set MasterBit {F0/0 1F1/0 1}#DD_Sequence random #array set DD_Sequence {F0/0 1F1/0 1}#------------------------------------------Ospf Network_LSA------------------------------------------------------#8 B32B32 OSPF.Network_LSA.Network_Mask OSPF.Network_LSA.Attached_Router*}